<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paper Package Calculator</title>
<style>
body {
  font-family: "Segoe UI", sans-serif;
  background: #eef2f6;
  margin: 0;
  padding: 10px;
}
.container {
  max-width: 100%;
  margin: auto;
  background: #fff;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 6px 12px rgba(0,0,0,0.1);
}
h2 {
  text-align: center;
  color: #0d47a1;
  margin-bottom: 10px;
}
.table-wrapper { overflow-x: auto; margin-bottom: 10px; }
table { width: 100%; border-collapse: collapse; min-width: 300px; }
th, td { padding: 8px; text-align: center; border: 1px solid #ddd; font-size: 14px; }
th { background: #0d47a1; color: #fff; font-weight: 600; }
tr:nth-child(even) { background: #f1f9ff; }
input, select { width: 95%; padding: 5px; border-radius: 6px; border: 1px solid #ccc; font-size: 14px; }
.note { color: #e53935; text-align: center; margin: 6px 0; font-weight: 500; }
#resultTable h3 { color: #0d47a1; font-size: 16px; text-align: center; margin-bottom: 5px; }
@media(max-width:600px){ input, select{ width:100%; font-size:13px; } }
</style>
</head>
<body>
<div class="container">
  <h2>ðŸ“„ Paper Package Calculator</h2>

  <div class="table-wrapper">
    <table>
      <tr>
        <td><label>Number of Books:</label></td>
        <td colspan="3">
          <input type="number" id="numBooks" placeholder="Enter number of books" oninput="createBookTable()">
        </td>
      </tr>
    </table>
  </div>

  <div id="bookTableContainer" class="table-wrapper"></div>
  <div class="note" id="noteMsg"></div>

  <div id="resultTable" style="display:none" class="table-wrapper">
    <h3>ðŸ“Š Calculation Result</h3>
    <table>
      <thead>
        <tr>
          <th>Paper + Material</th>
          <th>Total Packages</th>
        </tr>
      </thead>
      <tbody id="resultBody"></tbody>
    </table>
  </div>
</div>

<script>
function createBookTable() {
  const num = parseInt(document.getElementById("numBooks").value);
  const container = document.getElementById("bookTableContainer");
  container.innerHTML = "";
  if(isNaN(num)||num<=0) return;

  let tableHTML = `<table id="bookTable"><thead>
    <tr><th>Book #</th><th>Pages</th><th>Qty</th><th>Paper Type</th><th>Material</th></tr>
  </thead><tbody>`;

  for(let i=1;i<=num;i++){
    tableHTML += `<tr>
      <td>${i}</td>
      <td><input type="number" id="pages${i}" placeholder="Pages" oninput="updateCalculation()"></td>
      <td><input type="number" id="qty${i}" placeholder="Qty" oninput="updateCalculation()"></td>
      <td>
        <select id="paper${i}" onchange="updateCalculation()">
          <option value="A3">A3</option>
          <option value="A4">A4</option>
        </select>
      </td>
      <td>
        <select id="material${i}" onchange="updateCalculation()">
          <option value="GL">GL</option>
          <option value="WF">WF</option>
          <option value="MT">MT</option>
        </select>
      </td>
    </tr>`;
  }

  tableHTML += `</tbody></table>`;
  container.innerHTML = tableHTML;
  updateCalculation();
}

function getPaperRules(type, material){
  let cutting=0,sheets=0;
  if(type==="A3" && material==="GL"){cutting=4; sheets=100;}
  if(type==="A3" && material==="WF"){cutting=4; sheets=500;}
  if(type==="A3" && material==="MT"){cutting=8; sheets=250;}
  if(type==="A4" && material==="WF"){cutting=8; sheets=500;}
  if(type==="A4" && material==="MT"){cutting=8; sheets=250;}
  if(type==="A4" && material==="GL"){cutting=8; sheets=100;}
  return {cutting,sheets};
}

function updateCalculation(){
  const numBooks = parseInt(document.getElementById("numBooks").value);
  const resultBody = document.getElementById("resultBody");
  const resultTable = document.getElementById("resultTable");
  const noteMsg = document.getElementById("noteMsg");

  noteMsg.textContent=""; resultTable.style.display="none";
  if(isNaN(numBooks)||numBooks<=0) return;

  const totals = {}; // { "A3-WF": totalPackages, ... }

  for(let i=1;i<=numBooks;i++){
    const pages = parseInt(document.getElementById("pages"+i)?.value||0);
    const qty = parseInt(document.getElementById("qty"+i)?.value||0);
    const paper = document.getElementById("paper"+i)?.value;
    const material = document.getElementById("material"+i)?.value;
    if(pages<=0||qty<=0) continue;

    const key = `${paper}-${material}`;
    const {cutting,sheets} = getPaperRules(paper,material);
    if(cutting===0||sheets===0) continue;

    const subtotal = pages*qty;
    const afterCut = subtotal / cutting;
    const totalPackages = afterCut / sheets;

    if(totals[key]) totals[key] += totalPackages;
    else totals[key] = totalPackages;
  }

  if(Object.keys(totals).length===0) return;

  resultBody.innerHTML="";
  for(const key in totals){
    resultBody.innerHTML += `<tr><td>${key}</td><td>${totals[key].toFixed(2)}</td></tr>`;
  }
  resultTable.style.display="block";
}
</script>
</body>
</html>
